<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>

<!DOCTYPE html>
<html>
	<head>
    	<meta charset="utf-8">
		<title>新增@showName</title>
		<%@include file="/WEB-INF/jsp/decorators/addHeader.jsp" %>
	</head>
	<body>
 		<form id="saleForm" class="layui-form" style="margin-top:30px;">
 			<input  type="hidden" id="@primarykey" name="@primarykey" value="${@class.@primarykey}"/>
     		<div class="layui-form-item" >
@divFiled@
	 		</div>
	 		<div class="layui-input-block" style="margin-top:30px;margin-left:324px;">
	 			<input type="button" class="layui-btn" onclick="saveData()" value="确定"/>
       			<button class="layui-btn" name="cancleSubmit" >取消</button>
     		</div>
  		</form>
	</body>

	<script type="text/javascript">
		var reqUpdateAndAddUrl = "/admin/@class/insertAndUpdate";
	</script>

	<script type="text/javascript">
		//提交表单数据
		layui.use(['form', 'jquery', 'layedit', 'laydate'], function(){
			  var $ = layui.jquery;
			  var form = layui.form();
			  var layer = layui.layer;
			  var layedit = layui.layedit;
			  var laydate = layui.laydate;
			  form.verify({
			  });		  
@saveImg@
		});
	
	function saveData() {
@reqSave@
        var requestData={
@@saveReqDate@@
        };

        $.ajax({
            type:"POST",
            url: reqUpdateAndAddUrl,
            data: requestData,
            dataType:"json",
            success:function(result){
                var code = result.code;
                var msg = result.message;
                if(code=="200" || code=="201"){
                    layer.msg(msg);
                    var index = parent.layer.getFrameIndex(window.name); //获取窗口索引
                    parent.layer.close(index);//关闭父页面的弹窗
                    //刷新页面
                    parent.location.reload();
                }
            },
            error:function(){
                layer.msg("更新数据异常", {icon: 1,time: 1200},function(){
                    var index = parent.layer.getFrameIndex(window.name); //获取窗口索引
                    parent.layer.close(index);//关闭父页面的弹窗
                });
            }
        });
    }
	
</script>
</html>				 